<ng-container *ngIf="data">
  <ng-container *ngIf="data.label && data.layout?.hideLabel !== true">
    <label
      class="input-label"
      [controlLayout]="{
        type: 'label',
        layout: data.layout
      }"
      >{{ data.label }}</label
    >
  </ng-container>

  <!-- Description (before) -->
  <ng-container
    *ngIf="data?.description && data?.layout?.descriptionPosition !== 'after'"
    [ngTemplateOutlet]="descriptionTemplate"
    [ngTemplateOutletContext]="{
      description: data.description,
      layout: data.layout
    }"
  ></ng-container>

  <!-- Input component -->
  <div
    class="input-component"
    [ngClass]="{ hidden: loading && loadingComponent }"
  >
    <ng-container #inputComponentAnchor></ng-container>
  </div>

  <!-- Loading component -->
  <div class="loading-component" [ngClass]="{ hidden: !loading }">
    <ng-container #loadingComponentAnchor></ng-container>
  </div>

  <!-- Description (after) -->
  <ng-container
    *ngIf="data?.description && data?.layout?.descriptionPosition === 'after'"
    [ngTemplateOutlet]="descriptionTemplate"
    [ngTemplateOutletContext]="{
      description: data.description,
      layout: data.layout
    }"
  ></ng-container>

  <div
    [ngClass]="{
      hidden: !control?.errors || data.layout?.hideErrorMessage === true
    }"
  >
    <!-- Custom error message component -->
    <ng-container #errorComponentAnchor></ng-container>

    <!-- Default error message component -->
    <ng-container *ngIf="!errorMessageComponent">
      <error-message
        [control]="control"
        [validators]="data.validators"
      ></error-message>
    </ng-container>
  </div>
</ng-container>

<!-- Description template -->
<ng-template
  #descriptionTemplate
  let-description="description"
  let-layout="layout"
>
  <span
    class="input-description"
    [controlLayout]="{
      type: 'description',
      layout
    }"
    >{{ description }}</span
  >
</ng-template>
